/* =========================================================
   BASE / RESET + VARIABLES
   - Normaliza márgenes y modela el layout con box-sizing.
   - Define variables para colores, espaciamientos y duraciones.
   ========================================================= */
*,
*::before,
*::after { box-sizing: border-box; }

:root{
  /* Colores de UI */
  --c-bg:           #f4f4f4;
  --c-surface:      #ffffff;
  --c-header:       #f0f0f0;
  --c-border:       #cccccc;
  --c-muted:        #00000056;
  --c-shadow:       0 4px 8px rgba(0,0,0,.1);

  /* Estados */
  --c-row-current:  #eaf3ff;
  --c-inprogress:   #ffec99; /* 1 */
  --c-todo:         #99ccff; /* 2 */
  --c-extras:       #d9d9d9; /* 3 */
  --c-done:         #b2f0b2; /* 0,4 */
  --c-overdue:      #ff6666;

  /* Layout y motion */
  --radius:   15px;
  --radius-sm: 6px;
  --space:    20px;
  --gap:      8px;
  --anim-fast: .4s;
  --anim-base: 1s;

  /* Banda sticky (altura de fila activa; se actualiza desde JS) */
  --row-height: 48px;
}

/* Respeta preferencias de accesibilidad: reduce animaciones/transiciones */
@media (prefers-reduced-motion: reduce){
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Reset mínimo */
html, body { margin: 0; padding: 0; }
body {
  font-family: Arial, sans-serif;
  background: var(--c-bg);
  min-height: 100dvh;               /* Mejor para móviles que 100vh */
  display: grid; place-items: center; /* Centrado simple y robusto */
  text-align: center;
}

/* =========================================================
   ANIMACIONES DE ENTRADA
   - Aplicadas a título y contenedor al cargar.
   ========================================================= */
.fade-in { 
  opacity: 0; 
  transform: translateY(20px); 
  transition: opacity var(--anim-base) ease-out, transform var(--anim-base) ease-out; 
}
.fade-in.show { opacity: 1; transform: translateY(0); }

h2 { 
  opacity: 0; 
  transition: opacity var(--anim-base) ease-in-out; 
}
h2.show { opacity: 1; }

/* =========================================================
   CONTENEDOR PRINCIPAL
   ========================================================= */
.container {
  position: relative;
  background: var(--c-surface);
  padding: var(--space);
  border-radius: var(--radius);
  box-shadow: var(--c-shadow);
  width: min(1400px, 90%);          /* Ancho máximo razonable */
  height: 85vh;                     /* Conserva tu proporción original */
  display: flex; flex-direction: column;
  align-items: center; justify-content: flex-start;
  overflow: hidden;
  text-align: left;                 /* Para que el contenido interno se alinee a la izquierda */
}

/* Header: KPI izq, Título centrado real, Reloj der */
.page-header{
  width: 100%;
  display: grid;
  grid-template-columns: 1fr auto 1fr; /* [KPI] [TÍTULO] [vacío] */
  align-items: center;
  column-gap: 12px;
}
.page-header h2{
  margin: 0;
  grid-column: 2;
  justify-self: center;
  text-align: center;
}

.page-header .task-progress-card{
  grid-column: 1;        /* izquierda */
  justify-self: start;
}

/* =========================================================
   CONTROLES (FLECHAS) DE EMPLEADOS
   - Arriba a la derecha.
   - Unifica estilos de botones con :is() para evitar repetición.
   ========================================================= */
#employee-arrows {
  position: absolute; top: 20px; right: 20px;
  display: flex; gap: var(--gap);
}

/* Grupo de botones con mismo look (flechas + 'Hoy') */
:is(#employee-arrows button, .arrows-col button, #today-btn) {
  font: inherit;
  font-size: .8rem;
  text-transform: uppercase;
  letter-spacing: .1rem;
  background: transparent;
  border: 1px solid transparent;
  color: #000;
  cursor: pointer;
  padding: .3rem .6rem;
  border-radius: var(--radius-sm);
}
:is(#employee-arrows button, .arrows-col button, #today-btn):hover { 
  background: #f3f3f3; 
}
:is(#employee-arrows button, .arrows-col button, #today-btn):focus-visible { 
  outline: 2px solid #2d79f3; 
  outline-offset: 2px; 
}

/* =========================================================
   TABLA (CONTENEDOR CON SCROLL)
   - Scroll suave, scroll-snap para centrar filas.
   ========================================================= */
.table-wrapper {
  position: relative;
  width: 100%;
  flex: 1 1 auto;                   /* Ocupa el alto restante del contenedor */
  overflow-y: auto;
  opacity: 0; 
  transition: opacity var(--anim-base) ease-in-out;
  scroll-behavior: smooth;
  scroll-snap-type: y proximity;
}
.table-wrapper.show { opacity: 1; }

/* Banda “sticky” centrada (oculta por requerimiento) */
.sticky-center-band {
  display: none !important;
}

/* =========================================================
   ANIMACIONES DE TRANSICIÓN (DÍAS / PÁGINAS)
   - Solo usan transform/opacity (barato para el navegador).
   ========================================================= */
.slide-left-exit  { animation: slideLeftExit  var(--anim-fast) forwards; }
.slide-left-enter { animation: slideLeftEnter var(--anim-fast) forwards; }
.slide-right-exit { animation: slideRightExit var(--anim-fast) forwards; }
.slide-right-enter{ animation: slideRightEnter var(--anim-fast) forwards; }

@keyframes slideLeftExit  { 
  from { opacity:1; transform: translateX(0); }
  to   { opacity:0; transform: translateX(-40px); }
}
@keyframes slideLeftEnter { 
  from { opacity:0; transform: translateX(40px); }
  to   { opacity:1; transform: translateX(0); }
}
@keyframes slideRightExit { 
  from { opacity:1; transform: translateX(0); }
  to   { opacity:0; transform: translateX(40px); }
}
@keyframes slideRightEnter{ 
  from { opacity:0; transform: translateX(-40px); }
  to   { opacity:1; transform: translateX(0); }
}

/* =========================================================
   TABLA
   ========================================================= */
table {
  width: 100%; 
  border-collapse: collapse; 
  margin-top: 0; 
  /* fixed layout lets column widths be respected */
  table-layout: fixed;
}
thead {
  position: sticky; 
  top: 0; 
  z-index: 10; 
  background: var(--c-header);
  box-shadow: 0 2px 2px rgba(0, 0, 0, .1);
}
th, td {
  border: 1px solid var(--c-border); 
  padding: 5px; 
  text-align: center; 
  overflow: hidden;        /* Evita desbordes visuales */
  word-break: break-word;  /* Ajuste básico de palabras largas */
}
th { 
  background: var(--c-header); 
  font-weight: bold; 
  height: 50px; 
}

/* Ajustes de ancho para las primeras columnas: horario, actividad, puntos */
thead th:nth-child(1), tbody td:nth-child(1) {
  width: 90px;             /* Horario: estrecho */
}
thead th:nth-child(2), tbody td:nth-child(2) {
  width: 240px;           /* Actividad: menos ancho que antes */
  max-width: 240px;
}
thead th:nth-child(3), tbody td:nth-child(3) {
  width: 80px;            /* Puntos: pequeño */
}

/* Fila actual (hora actual) */
tbody tr.current-row { background: var(--c-row-current); }

/* Cada fila “snapea” al centro del contenedor */
tbody tr { scroll-snap-align: center; }

/* =========================================================
   ENCABEZADO DE TRABAJADORES (FOTO + NOMBRE + PUESTO)
   - Layout vertical (column) para encajar en header estrecho.
   ========================================================= */
.worker-header {
  display: flex; 
  flex-direction: column;
  align-items: center; 
  justify-content: center;
  gap: 3px;
  padding: 0;
  white-space: nowrap;
}
.worker-header img {
  width: 50px; 
  height: 50px; 
  border-radius: 50%; 
  border: 2px solid #ffffff;
  box-shadow: 0 4px 8px rgba(0, 0, 0, .2); /* Solo en imagen, no en filas (mejor rendimiento) */
}
.worker-text { 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  max-width: 100%; 
  white-space: normal; 
  text-align: center; 
  width: 100%;
}
.worker-header .worker-name { 
  font-weight: bold; 
  font-size: 14px; 
  text-align: center; 
  overflow-wrap: anywhere; /* Rompe palabras largas de forma amable */
}
.worker-header .worker-role { 
  font-size: 12px; 
  color: var(--c-muted); 
  white-space: normal; 
  overflow-wrap: anywhere;
  text-align: center; 
}

/* =========================================================
   ESTADOS DE CELDAS DE TAREAS
   ========================================================= */
.status-inprogress { background: var(--c-inprogress); } /* 1 - En progreso */
.status-todo       { background: var(--c-todo); }       /* 2 - Por hacer   */
.status-extras     { background: var(--c-extras); }     /* 3 - Extras      */
.status-done       { background: var(--c-done); }       /* 0/4 - Hecho     */
.status-overdue    { background: var(--c-overdue) !important; }

/* =========================================================
   RELOJ
   - Las horas/min/seg usan ::before con variables actualizadas por JS.
   - El día (#tasks-day) se escribe como texto desde JS (no pseudo-element).
   ========================================================= */
.clock-container {
  opacity: 0; 
  transition: opacity var(--anim-base) ease-in-out;
  margin: 5px 0; 
  background: var(--c-surface); 
  border-radius: 3px; 
  padding: 5px 8px;
  display: flex; 
  align-items: center;
}
.clock-container.show { opacity: 1; }

.clock-col { 
  text-align: center; 
  margin: 0 10px; 
  min-width: 20px; 
  position: relative; 
}
/* Separadores verticales discretos entre columnas de reloj */
.clock-col:not(:last-child)::before,
.clock-col:not(:last-child)::after {
  content: ""; 
  background: rgba(0,0,0,.3); 
  height: 2px; 
  width: 2px; 
  border-radius: 50%;
  display: block; 
  position: absolute; 
  right: -4px;
}
.clock-col:not(:last-child)::before { top: 40%; }
.clock-col:not(:last-child)::after  { top: 60%; }

/* Piezas del reloj (contenido desde variables CSS) */
.clock-hours::before   { content: var(--timer-hours); }
.clock-minutes::before { content: var(--timer-minutes); }
.clock-seconds::before { content: var(--timer-seconds); }

/* Ocultar columnas de hora/min/seg si NO es hoy */
.hidden { display: none !important; }

/* Texto de actividad (columna 2) */
.activity-name { font-weight: bold; margin-bottom: 4px; }
.activity-desc { font-size: .9rem; color: #555; line-height: 1.2; }

/* =========================================================
   MODAL
   ========================================================= */
.modal {
  position: fixed;
  inset: 0;                        /* top/right/bottom/left:0 */
  background: rgba(0,0,0,0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}
.modal.hidden { display: none; }

.modal-content {
  position: relative;
  background: var(--c-surface);
  padding: 20px;
  border-radius: 8px;
  max-width: 400px;
  width: 90%;
  text-align: center;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  z-index: 10000;
}
.modal-close {
  position: absolute;
  top: 15px; right: 20px;
  font-size: 24px;
  cursor: pointer;
  background: transparent;
  border: 0;
}
.modal-actions {
  margin-top: 20px;
  display: flex;
  gap: 10px;
  justify-content: space-between;
}
.modal-actions button {
  padding: 8px 12px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
#modal-close-btn { background: #ccc; }
#modal-complete-btn { background: #2d79f3; color: #fff; }

/* ===== KPI compacto (igual al de la imagen) ===== */
.task-progress-card{
  grid-column: 1;                 /* lo deja a la izquierda */
  justify-self: start;
  display: inline-flex;
  align-items: center;
  gap: 18px;                      /* espacio entre donut y panel lateral */
  padding: 6px 10px;

 
}

/* Donut reducido: usamos el SVG 120x120 pero lo escalamos */
.task-progress-card .chart{
  position: relative;
  width: 72px;                    /* tamaño visual del contenedor */
  height: 72px;
  transform: scale(0.60);         /* reduce el donut (incluye grosores) */
  transform-origin: left center;
}

/* Texto central del donut */
.task-progress-card .chart .chart-text{
  padding-left: 2.6em;
  padding-top: 2.6em;
  position: absolute; 
  inset: 0;
  display: flex; 
  flex-direction: column;
  align-items: center; 
  justify-content: center;
}
#chartCountG   { font-weight: 700; font-size: 1.5rem; color: #2d79f3; } /* azul como el donut */
#chartPercentG { font-size: 1rem; color: #111; }

/* Colores del anillo (por si no hereda de otro css) */
.progress-ring__track             { stroke: #eeeeee; stroke-width: 10; }
.progress-ring__circle.completed     { stroke: #2d79f3; stroke-width: 18; }

/* ===== Panel lateral (leyenda + separador + extras) ===== */
.task-progress-card .side-panel{
  display: inline-flex;
  align-items: center;
  gap: 18px;
}

/* Leyenda (dos filas) */
.task-progress-card .legend{
  display: grid;
  row-gap: 10px;
}
.task-progress-card .legend-item{
  display: inline-flex; align-items: center; gap: 8px;
  line-height: 1.15;
  font-size: .92rem;               /* pequeño como en la imagen */
  color: #111;
}
.task-progress-card .legend-color{
  width: 12px; height: 12px; border-radius: 3px;
  display: inline-block;
}
.task-progress-card .legend-color.completed     { background: #2d79f3; }
.task-progress-card .legend-color.not-completed { background: #ff7a66; }
.task-progress-card .legend-color.extras        { background: var(--c-done); }

/* Separador vertical fino */
.task-progress-card .v-sep{
  width: 1px; height: 52px;
  background: #cfcfcf;
}

/* Bloque de “Tareas extra realizadas” (título arriba, número abajo) */
.task-progress-card .extras-panel{
  display: grid;
  row-gap: 6px;
  text-align: center;
}
.task-progress-card .extras-item{
  display: inline-flex; align-items: center; gap: 8px;
  justify-content: center;
  font-size: .92rem;
}
.task-progress-card .extras-count{
  font-weight: 700;
  font-size: 1rem;
}

/* ===== Menú contextual de celda (Información / Crear / Editar) ===== */
/* Encabezado de trabajador clicable */
.worker-header{ cursor: pointer; user-select: none; }
.worker-header:hover{ filter: brightness(0.98); }

/* ===== Menú contextual (encabezado de trabajador) ===== */
.cell-menu{
  position: fixed; /* se posiciona con JS en left/top */
  z-index: 10000;
  background: var(--c-surface);
  border: 1px solid var(--c-border);
  border-radius: 8px;
  box-shadow: var(--c-shadow);
  padding: 6px;
  min-width: 180px;
  display: none;
}
.cell-menu.hidden{ display: none; }
.cell-menu:not(.hidden){ display: block; }

.cell-menu .menu-item{
  display: block;
  width: 100%;
  text-align: left;
  padding: 8px 10px;
  border: 0;
  background: transparent;
  font: inherit;
  cursor: pointer;
  border-radius: 6px;
}
.cell-menu .menu-item:hover{ background: #f3f3f3; }
.cell-menu .menu-item:active{ background: #e9e9e9; }


/* =========================================================
   MODAL DE CREACIÓN DE TAREA
   ========================================================= */
#modal-create-task .form-scope-container {
  background: var(--c-surface);
  border-radius: var(--radius);
  padding: 20px;
  width: 100%;
  max-width: 450px;
  box-shadow: var(--c-shadow);
  text-align: left;
}

#modal-create-task h2,
#modal-create-task h3 {
  margin-top: 0;
  color: #111;
  font-weight: 700;
  text-align: center;
}

#modal-create-task form {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* Inputs con estilo claro */
#modal-create-task .inputGroup {
  position: relative;
  display: flex;
  flex-direction: column;
}

#modal-create-task .inputGroup input {
  padding: 10px;
  border: 1px solid var(--c-border);
  border-radius: var(--radius-sm);
  background: #fafafa; /* un poco más claro que el blanco */
  color: #111;
  font-size: 1rem;
}

#modal-create-task .inputGroup input:focus {
  outline: 2px solid #2d79f3;
  background: #fff;
}

/* Label flotante arriba del input */
#modal-create-task .inputGroup label {
  margin-top: 6px;
  font-size: .85rem;
  color: var(--c-muted);
}

/* Checkbox de días */
#modal-create-task .checkbox-container {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

#modal-create-task .dia-checkbox {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: .9rem;
  background: #fafafa;
  border: 1px solid var(--c-border);
  border-radius: var(--radius-sm);
  padding: 6px 10px;
  cursor: pointer;
  transition: background .2s;
}

#modal-create-task .dia-checkbox:hover {
  background: #f0f0f0;
}

#modal-create-task .dia-checkbox input {
  display: none;
}

#modal-create-task .checkbox-label {
  color: #111;
}

/* Botón de asignar */
#modal-create-task #asignarTareaBtn {
  background: #2d79f3;
  color: #fff;
  border: none;
  border-radius: var(--radius-sm);
  padding: 10px 14px;
  font-size: 1rem;
  cursor: pointer;
  transition: background .2s;
}

#modal-create-task #asignarTareaBtn:hover {
  background: #1b5fcc;
}
.profile-menu {
  position: fixed;
  z-index: 10000;
  background: var(--c-surface);
  border: 1px solid var(--c-border);
  border-radius: 8px;
  box-shadow: var(--c-shadow);
  padding: 6px;
  min-width: 180px;
  display: none; /* estado base */
}

.profile-menu.pm-hidden {
  display: none !important;
}

.profile-menu.show {
  display: block;
}